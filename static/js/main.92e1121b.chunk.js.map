{"version":3,"sources":["TextEditor.js","App.js","index.js"],"names":["TOOLBAR_OPTIONS","header","font","list","color","background","script","align","TextEditor","documentId","useParams","id","useState","socket","setSocket","quill","setQuill","console","log","useEffect","s","io","disconnect","once","document","setContents","enable","emit","interval","setInterval","getContents","clearInterval","handler","delta","updateContents","on","off","oldDelta","source","wrapperRef","useCallback","wrapper","innerHtml","editor","createElement","append","q","Quill","theme","modules","toolbar","disable","setText","className","ref","App","path","exact","to","uuidV4","ReactDOM","render","StrictMode","getElementById"],"mappings":"yNAOMA,EAAkB,CACpB,CAAC,CAAEC,OAAQ,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAAG,KAC9B,CAAC,CAAEC,KAAM,KACT,CAAC,CAAEC,KAAM,WAAa,CAAEA,KAAM,WAC9B,CAAC,OAAQ,SAAU,aACnB,CAAC,CAAEC,MAAO,IAAM,CAAEC,WAAY,KAC9B,CAAC,CAAEC,OAAQ,OAAS,CAAEA,OAAQ,UAC9B,CAAC,CAAEC,MAAO,KACV,CAAC,QAAS,aAAc,cACxB,CAAC,UAGU,SAASC,IAAc,IACtBC,EAAeC,cAAnBC,GADyB,EAELC,qBAFK,mBAE1BC,EAF0B,KAElBC,EAFkB,OAGPF,qBAHO,mBAG1BG,EAH0B,KAGnBC,EAHmB,KAIjCC,QAAQC,IAAIT,GAGZU,qBAAU,WACN,IAAMC,EAAIC,YAAG,yBAGb,OAFAP,EAAUM,GAEH,WACHA,EAAEE,gBAEP,IAEHH,qBAAU,WACDN,GAAWE,IAEhBF,EAAOU,KAAK,iBAAiB,SAAAC,GACzBT,EAAMU,YAAYD,GAClBT,EAAMW,YAGVb,EAAOc,KAAK,eAAgBlB,MAC9B,CAACI,EAAQE,EAAON,IAElBU,qBAAU,WACN,GAAKN,GAAWE,EAAhB,CAEA,IAAMa,EAAWC,aAAY,WACzBhB,EAAOc,KAAK,gBAAiBZ,EAAMe,iBA5CtB,KA+CjB,OAAO,WACHC,cAAcH,OAEnB,CAACf,EAAQE,IAEZI,qBAAU,WACN,GAAKN,GAAWE,EAAhB,CAEA,IAAMiB,EAAU,SAACC,GACblB,EAAMmB,eAAeD,IAIzB,OAFApB,EAAOsB,GAAG,kBAAmBH,GAEtB,WACHnB,EAAOuB,IAAI,kBAAmBJ,OAEnC,CAACnB,EAAQE,IAEZI,qBAAU,WACN,GAAKN,GAAWE,EAAhB,CAEA,IAAMiB,EAAU,SAACC,EAAOI,EAAUC,GACf,SAAXA,GACJzB,EAAOc,KAAK,eAAgBM,IAIhC,OAFAlB,EAAMoB,GAAG,cAAeH,GAEjB,WACHjB,EAAMqB,IAAI,cAAeJ,OAE9B,CAACnB,EAAQE,IAEZ,IAAMwB,EAAaC,uBAAY,SAACC,GAC5B,GAAKA,EAAL,CACAA,EAAQC,UAAY,GACpB,IAAMC,EAASnB,SAASoB,cAAc,OACtCH,EAAQI,OAAOF,GACf,IAAMG,EAAI,IAAIC,IAAMJ,EAAQ,CAACK,MAAO,OAAQC,QAAS,CAACC,QAASlD,KAC/D8C,EAAEK,UACFL,EAAEM,QAAQ,cACVpC,EAAS8B,MACV,IACH,OACI,qBAAKO,UAAU,YAAYC,IAAOf,I,oBCxE3BgB,MAff,WACE,OACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOC,KAAK,IAAIC,OAAK,EAArB,SACE,cAAC,IAAD,CAAUC,GAAE,qBAAgBC,mBAE9B,cAAC,IAAD,CAAOH,KAAK,iBAAZ,SACE,cAAChD,EAAD,Y,MCXVoD,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFtC,SAASuC,eAAe,W","file":"static/js/main.92e1121b.chunk.js","sourcesContent":["import { useEffect, useCallback, useState } from 'react'\nimport Quill from 'quill'\nimport \"quill/dist/quill.snow.css\"\nimport { io } from 'socket.io-client'\nimport { useParams } from 'react-router-dom'\n\nconst SAVE_INTERVAL_MS = 2000\nconst TOOLBAR_OPTIONS = [\n    [{ header: [1, 2, 3, 4, 5, 6, false] }],\n    [{ font: [] }],\n    [{ list: \"ordered\" }, { list: \"bullet\" }],\n    [\"bold\", \"italic\", \"underline\"],\n    [{ color: [] }, { background: [] }],\n    [{ script: \"sub\" }, { script: \"super\" }],\n    [{ align: [] }],\n    [\"image\", \"blockquote\", \"code-block\"],\n    [\"clean\"],\n]\n\nexport default function TextEditor() {\n    const { id: documentId } = useParams()\n    const [socket, setSocket] = useState()\n    const [quill, setQuill] = useState()\n    console.log(documentId)\n\n\n    useEffect(() => {\n        const s = io(\"http://localhost:3003\")\n        setSocket(s)\n\n        return () => {\n            s.disconnect()\n        }\n    }, [])\n\n    useEffect(() => {\n        if (!socket || !quill) return\n\n        socket.once('load-document', document => {\n            quill.setContents(document)\n            quill.enable()\n        })\n\n        socket.emit('get-document', documentId)\n    },[socket, quill, documentId])\n\n    useEffect(() => {\n        if (!socket || !quill) return\n\n        const interval = setInterval(() => {\n            socket.emit('save-document', quill.getContents())\n        }, SAVE_INTERVAL_MS)\n\n        return () => {\n            clearInterval(interval)\n        }\n    }, [socket, quill])\n\n    useEffect(() => {\n        if (!socket || !quill) return\n\n        const handler = (delta) => {\n            quill.updateContents(delta)\n        }\n        socket.on('receive-changes', handler)\n\n        return () => {\n            socket.off('receive-changes', handler)\n        }\n    }, [socket, quill])\n\n    useEffect(() => {\n        if (!socket || !quill) return\n\n        const handler = (delta, oldDelta, source) => {\n            if (source !== 'user') return\n            socket.emit(\"send-changes\", delta)\n        }\n        quill.on('text-change', handler)\n\n        return () => {\n            quill.off('text-change', handler)\n        }\n    }, [socket, quill])\n\n    const wrapperRef = useCallback((wrapper) => {\n        if (!wrapper) return\n        wrapper.innerHtml = ''\n        const editor = document.createElement('div')\n        wrapper.append(editor)\n        const q = new Quill(editor, {theme: \"snow\", modules: {toolbar: TOOLBAR_OPTIONS}})\n        q.disable()\n        q.setText('Loading...')\n        setQuill(q)\n    }, [])\n    return (\n        <div className=\"container\" ref = {wrapperRef}>\n        </div>\n    )\n}\n","import TextEditor from \"./TextEditor\"\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Redirect,\n} from \"react-router-dom\"\nimport { v4 as uuidV4 } from \"uuid\"\n\nfunction App() {\n  return (\n    <Router>\n      <Switch>\n        <Route path=\"/\" exact>\n          <Redirect to={`/documents/${uuidV4()}`} />\n        </Route>\n        <Route path=\"/documents/:id\">\n          <TextEditor />\n        </Route>\n      </Switch>\n    </Router>\n  )\n}\n\nexport default App","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport \"./styles.css\"\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n//reportWebVitals();\n"],"sourceRoot":""}